import{h as q,bf as Xe,bg as le,bh as Ge,S as be,bi as We,bj as _e,bk as he,bl as Te,bm as Ee,bn as ce,bo as Ke,i as Ie,bp as Le,bq as Ue,q as ze,d as J,b2 as Pe,v as me,A as fe,br as Ae,bs as qe,bt as Ve,ap as $e,C as Me,aa as Ze,r as $,bu as Je,s as Qe,e as C,w as pe,V as ke,o as Be,G as P,H as ye,P as L,I as H,K as z,L as S,u as i,M as we,au as je,$ as F,av as G,b1 as en,O as X,Q as oe,aG as nn,aH as an,bv as tn,b5 as rn,Z as sn,bw as ln,bx as on,az as un,J as fn,N as cn,Y as ie,T as dn,ae as vn,_ as De,ac as U,E as V,by as gn,a1 as He,ao as mn,bz as pn,a9 as yn,a7 as wn,aF as bn,aj as _n,bA as hn}from"./index-CHNotA-O.js";import{g as Tn}from"./focus-trap-_TIbJVKn.js";const En=(e,n)=>{if(!q||!e||!n)return!1;const a=e.getBoundingClientRect();let r;return n instanceof Element?r=n.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},a.top<r.bottom&&a.bottom>r.top&&a.right>r.left&&a.left<r.right};var In=/\s/;function Ln(e){for(var n=e.length;n--&&In.test(e.charAt(n)););return n}var An=/^\s+/;function Sn(e){return e&&e.slice(0,Ln(e)+1).replace(An,"")}var Se=NaN,On=/^[-+]0x[0-9a-f]+$/i,xn=/^0b[01]+$/i,Cn=/^0o[0-7]+$/i,Nn=parseInt;function Oe(e){if(typeof e=="number")return e;if(Xe(e))return Se;if(le(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=le(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=Sn(e);var a=xn.test(e);return a||Cn.test(e)?Nn(e.slice(2),a?2:8):On.test(e)?Se:+e}var Rn="__lodash_hash_undefined__";function zn(e){return this.__data__.set(e,Rn),this}function Pn(e){return this.__data__.has(e)}function ue(e){var n=-1,a=e==null?0:e.length;for(this.__data__=new Ge;++n<a;)this.add(e[n])}ue.prototype.add=ue.prototype.push=zn;ue.prototype.has=Pn;function $n(e,n){for(var a=-1,r=e==null?0:e.length;++a<r;)if(n(e[a],a,e))return!0;return!1}function Mn(e,n){return e.has(n)}var kn=1,Bn=2;function Fe(e,n,a,r,l,t){var m=a&kn,s=e.length,v=n.length;if(s!=v&&!(m&&v>s))return!1;var g=t.get(e),b=t.get(n);if(g&&b)return g==n&&b==e;var y=-1,c=!0,d=a&Bn?new ue:void 0;for(t.set(e,n),t.set(n,e);++y<s;){var _=e[y],f=n[y];if(r)var T=m?r(f,_,y,n,e,t):r(_,f,y,e,n,t);if(T!==void 0){if(T)continue;c=!1;break}if(d){if(!$n(n,function(I,A){if(!Mn(d,A)&&(_===I||l(_,I,a,r,t)))return d.push(A)})){c=!1;break}}else if(!(_===f||l(_,f,a,r,t))){c=!1;break}}return t.delete(e),t.delete(n),c}function Dn(e){var n=-1,a=Array(e.size);return e.forEach(function(r,l){a[++n]=[l,r]}),a}function Hn(e){var n=-1,a=Array(e.size);return e.forEach(function(r){a[++n]=r}),a}var Fn=1,Yn=2,Xn="[object Boolean]",Gn="[object Date]",Wn="[object Error]",Kn="[object Map]",Un="[object Number]",qn="[object RegExp]",Vn="[object Set]",Zn="[object String]",Jn="[object Symbol]",Qn="[object ArrayBuffer]",jn="[object DataView]",xe=be?be.prototype:void 0,de=xe?xe.valueOf:void 0;function ea(e,n,a,r,l,t,m){switch(a){case jn:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case Qn:return!(e.byteLength!=n.byteLength||!t(new _e(e),new _e(n)));case Xn:case Gn:case Un:return We(+e,+n);case Wn:return e.name==n.name&&e.message==n.message;case qn:case Zn:return e==n+"";case Kn:var s=Dn;case Vn:var v=r&Fn;if(s||(s=Hn),e.size!=n.size&&!v)return!1;var g=m.get(e);if(g)return g==n;r|=Yn,m.set(e,n);var b=Fe(s(e),s(n),r,l,t,m);return m.delete(e),b;case Jn:if(de)return de.call(e)==de.call(n)}return!1}var na=1,aa=Object.prototype,ta=aa.hasOwnProperty;function ra(e,n,a,r,l,t){var m=a&na,s=he(e),v=s.length,g=he(n),b=g.length;if(v!=b&&!m)return!1;for(var y=v;y--;){var c=s[y];if(!(m?c in n:ta.call(n,c)))return!1}var d=t.get(e),_=t.get(n);if(d&&_)return d==n&&_==e;var f=!0;t.set(e,n),t.set(n,e);for(var T=m;++y<v;){c=s[y];var I=e[c],A=n[c];if(r)var Y=m?r(A,I,c,n,e,t):r(I,A,c,e,n,t);if(!(Y===void 0?I===A||l(I,A,a,r,t):Y)){f=!1;break}T||(T=c=="constructor")}if(f&&!T){var N=e.constructor,R=n.constructor;N!=R&&"constructor"in e&&"constructor"in n&&!(typeof N=="function"&&N instanceof N&&typeof R=="function"&&R instanceof R)&&(f=!1)}return t.delete(e),t.delete(n),f}var sa=1,Ce="[object Arguments]",Ne="[object Array]",se="[object Object]",ia=Object.prototype,Re=ia.hasOwnProperty;function la(e,n,a,r,l,t){var m=Ie(e),s=Ie(n),v=m?Ne:Te(e),g=s?Ne:Te(n);v=v==Ce?se:v,g=g==Ce?se:g;var b=v==se,y=g==se,c=v==g;if(c&&Ee(e)){if(!Ee(n))return!1;m=!0,b=!1}if(c&&!b)return t||(t=new ce),m||Ke(e)?Fe(e,n,a,r,l,t):ea(e,n,v,a,r,l,t);if(!(a&sa)){var d=b&&Re.call(e,"__wrapped__"),_=y&&Re.call(n,"__wrapped__");if(d||_){var f=d?e.value():e,T=_?n.value():n;return t||(t=new ce),l(f,T,a,r,t)}}return c?(t||(t=new ce),ra(e,n,a,r,l,t)):!1}function Ye(e,n,a,r,l){return e===n?!0:e==null||n==null||!Le(e)&&!Le(n)?e!==e&&n!==n:la(e,n,a,r,Ye,l)}var ve=function(){return Ue.Date.now()},oa="Expected a function",ua=Math.max,fa=Math.min;function ca(e,n,a){var r,l,t,m,s,v,g=0,b=!1,y=!1,c=!0;if(typeof e!="function")throw new TypeError(oa);n=Oe(n)||0,le(a)&&(b=!!a.leading,y="maxWait"in a,t=y?ua(Oe(a.maxWait)||0,n):t,c="trailing"in a?!!a.trailing:c);function d(w){var O=r,M=l;return r=l=void 0,g=w,m=e.apply(M,O),m}function _(w){return g=w,s=setTimeout(I,n),b?d(w):m}function f(w){var O=w-v,M=w-g,W=n-O;return y?fa(W,t-M):W}function T(w){var O=w-v,M=w-g;return v===void 0||O>=n||O<0||y&&M>=t}function I(){var w=ve();if(T(w))return A(w);s=setTimeout(I,f(w))}function A(w){return s=void 0,c&&r?d(w):(r=l=void 0,m)}function Y(){s!==void 0&&clearTimeout(s),g=0,r=v=l=s=void 0}function N(){return s===void 0?m:A(ve())}function R(){var w=ve(),O=T(w);if(r=arguments,l=this,v=w,O){if(s===void 0)return _(v);if(y)return clearTimeout(s),s=setTimeout(I,n),d(v)}return s===void 0&&(s=setTimeout(I,n)),m}return R.cancel=Y,R.flush=N,R}function xa(e,n){return Ye(e,n)}var da="Expected a function";function ge(e,n,a){var r=!0,l=!0;if(typeof e!="function")throw new TypeError(da);return le(a)&&(r="leading"in a?!!a.leading:r,l="trailing"in a?!!a.trailing:l),ca(e,n,{leading:r,maxWait:n,trailing:l})}const va=ze({urlList:{type:J(Array),default:()=>Pe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:J(String)}}),ga={close:()=>!0,switch:e=>me(e),rotate:e=>me(e)},ma=["src","crossorigin"],pa=fe({name:"ElImageViewer"}),ya=fe({...pa,props:va,emits:ga,setup(e,{expose:n,emit:a}){var r;const l=e,t={CONTAIN:{name:"contain",icon:Ae(qe)},ORIGINAL:{name:"original",icon:Ae(Ve)}},{t:m}=$e(),s=Me("image-viewer"),{nextZIndex:v}=Ze(),g=$(),b=$([]),y=Je(),c=$(!0),d=$(l.initialIndex),_=Qe(t.CONTAIN),f=$({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),T=$((r=l.zIndex)!=null?r:v()),I=C(()=>{const{urlList:u}=l;return u.length<=1}),A=C(()=>d.value===0),Y=C(()=>d.value===l.urlList.length-1),N=C(()=>l.urlList[d.value]),R=C(()=>[s.e("btn"),s.e("prev"),s.is("disabled",!l.infinite&&A.value)]),w=C(()=>[s.e("btn"),s.e("next"),s.is("disabled",!l.infinite&&Y.value)]),O=C(()=>{const{scale:u,deg:p,offsetX:h,offsetY:k,enableTransition:D}=f.value;let x=h/u,B=k/u;switch(p%360){case 90:case-270:[x,B]=[B,-x];break;case 180:case-180:[x,B]=[-x,-B];break;case 270:case-90:[x,B]=[-B,x];break}const K={transform:`scale(${u}) rotate(${p}deg) translate(${x}px, ${B}px)`,transition:D?"transform .3s":""};return _.value.name===t.CONTAIN.name&&(K.maxWidth=K.maxHeight="100%"),K});function M(){Q(),a("close")}function W(){const u=ge(h=>{switch(h.code){case U.esc:l.closeOnPressEscape&&M();break;case U.space:te();break;case U.left:re();break;case U.up:E("zoomIn");break;case U.right:o();break;case U.down:E("zoomOut");break}}),p=ge(h=>{const k=h.deltaY||h.deltaX;E(k<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});y.run(()=>{V(document,"keydown",u),V(document,"wheel",p)})}function Q(){y.stop()}function j(){c.value=!1}function ee(u){c.value=!1,u.target.alt=m("el.image.error")}function ne(u){if(c.value||u.button!==0||!g.value)return;f.value.enableTransition=!1;const{offsetX:p,offsetY:h}=f.value,k=u.pageX,D=u.pageY,x=ge(K=>{f.value={...f.value,offsetX:p+K.pageX-k,offsetY:h+K.pageY-D}}),B=V(document,"mousemove",x);V(document,"mouseup",()=>{B()}),u.preventDefault()}function ae(){f.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function te(){if(c.value)return;const u=gn(t),p=Object.values(t),h=_.value.name,D=(p.findIndex(x=>x.name===h)+1)%u.length;_.value=t[u[D]],ae()}function Z(u){const p=l.urlList.length;d.value=(u+p)%p}function re(){A.value&&!l.infinite||Z(d.value-1)}function o(){Y.value&&!l.infinite||Z(d.value+1)}function E(u,p={}){if(c.value)return;const{minScale:h,maxScale:k}=l,{zoomRate:D,rotateDeg:x,enableTransition:B}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...p};switch(u){case"zoomOut":f.value.scale>h&&(f.value.scale=Number.parseFloat((f.value.scale/D).toFixed(3)));break;case"zoomIn":f.value.scale<k&&(f.value.scale=Number.parseFloat((f.value.scale*D).toFixed(3)));break;case"clockwise":f.value.deg+=x,a("rotate",f.value.deg);break;case"anticlockwise":f.value.deg-=x,a("rotate",f.value.deg);break}f.value.enableTransition=B}return pe(N,()=>{ke(()=>{const u=b.value[0];u!=null&&u.complete||(c.value=!0)})}),pe(d,u=>{ae(),a("switch",u)}),Be(()=>{var u,p;W(),(p=(u=g.value)==null?void 0:u.focus)==null||p.call(u)}),n({setActiveItem:Z}),(u,p)=>(P(),ye(vn,{to:"body",disabled:!u.teleported},[L(dn,{name:"viewer-fade",appear:""},{default:H(()=>[z("div",{ref_key:"wrapper",ref:g,tabindex:-1,class:S(i(s).e("wrapper")),style:we({zIndex:T.value})},[z("div",{class:S(i(s).e("mask")),onClick:p[0]||(p[0]=je(h=>u.hideOnClickModal&&M(),["self"]))},null,2),F(" CLOSE "),z("span",{class:S([i(s).e("btn"),i(s).e("close")]),onClick:M},[L(i(G),null,{default:H(()=>[L(i(en))]),_:1})],2),F(" ARROW "),i(I)?F("v-if",!0):(P(),X(oe,{key:0},[z("span",{class:S(i(R)),onClick:re},[L(i(G),null,{default:H(()=>[L(i(nn))]),_:1})],2),z("span",{class:S(i(w)),onClick:o},[L(i(G),null,{default:H(()=>[L(i(an))]),_:1})],2)],64)),F(" ACTIONS "),z("div",{class:S([i(s).e("btn"),i(s).e("actions")])},[z("div",{class:S(i(s).e("actions__inner"))},[L(i(G),{onClick:p[1]||(p[1]=h=>E("zoomOut"))},{default:H(()=>[L(i(tn))]),_:1}),L(i(G),{onClick:p[2]||(p[2]=h=>E("zoomIn"))},{default:H(()=>[L(i(rn))]),_:1}),z("i",{class:S(i(s).e("actions__divider"))},null,2),L(i(G),{onClick:te},{default:H(()=>[(P(),ye(sn(i(_).icon)))]),_:1}),z("i",{class:S(i(s).e("actions__divider"))},null,2),L(i(G),{onClick:p[3]||(p[3]=h=>E("anticlockwise"))},{default:H(()=>[L(i(ln))]),_:1}),L(i(G),{onClick:p[4]||(p[4]=h=>E("clockwise"))},{default:H(()=>[L(i(on))]),_:1})],2)],2),F(" CANVAS "),z("div",{class:S(i(s).e("canvas"))},[(P(!0),X(oe,null,un(u.urlList,(h,k)=>fn((P(),X("img",{ref_for:!0,ref:D=>b.value[k]=D,key:h,src:h,style:we(i(O)),class:S(i(s).e("img")),crossorigin:u.crossorigin,onLoad:j,onError:ee,onMousedown:ne},null,46,ma)),[[cn,k===d.value]])),128))],2),ie(u.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var wa=De(ya,[["__file","image-viewer.vue"]]);const ba=He(wa),_a=ze({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:J([String,Object])},previewSrcList:{type:J(Array),default:()=>Pe([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:J(String)}}),ha={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>me(e),close:()=>!0,show:()=>!0},Ta=["src","loading","crossorigin"],Ea={key:0},Ia=fe({name:"ElImage",inheritAttrs:!1}),La=fe({...Ia,props:_a,emits:ha,setup(e,{emit:n}){const a=e;let r="";const{t:l}=$e(),t=Me("image"),m=mn(),s=pn(),v=$(),g=$(!1),b=$(!0),y=$(!1),c=$(),d=$(),_=q&&"loading"in HTMLImageElement.prototype;let f,T;const I=C(()=>[t.e("inner"),N.value&&t.e("preview"),b.value&&t.is("loading")]),A=C(()=>m.style),Y=C(()=>{const{fit:o}=a;return q&&o?{objectFit:o}:{}}),N=C(()=>{const{previewSrcList:o}=a;return Array.isArray(o)&&o.length>0}),R=C(()=>{const{previewSrcList:o,initialIndex:E}=a;let u=E;return E>o.length-1&&(u=0),u}),w=C(()=>a.loading==="eager"?!1:!_&&a.loading==="lazy"||a.lazy),O=()=>{q&&(b.value=!0,g.value=!1,v.value=a.src)};function M(o){b.value=!1,g.value=!1,n("load",o)}function W(o){b.value=!1,g.value=!0,n("error",o)}function Q(){En(c.value,d.value)&&(O(),ne())}const j=hn(Q,200,!0);async function ee(){var o;if(!q)return;await ke();const{scrollContainer:E}=a;wn(E)?d.value=E:bn(E)&&E!==""?d.value=(o=document.querySelector(E))!=null?o:void 0:c.value&&(d.value=Tn(c.value)),d.value&&(f=V(d,"scroll",j),setTimeout(()=>Q(),100))}function ne(){!q||!d.value||!j||(f==null||f(),d.value=void 0)}function ae(o){if(o.ctrlKey){if(o.deltaY<0)return o.preventDefault(),!1;if(o.deltaY>0)return o.preventDefault(),!1}}function te(){N.value&&(T=V("wheel",ae,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",y.value=!0,n("show"))}function Z(){T==null||T(),document.body.style.overflow=r,y.value=!1,n("close")}function re(o){n("switch",o)}return pe(()=>a.src,()=>{w.value?(b.value=!0,g.value=!1,ne(),ee()):O()}),Be(()=>{w.value?ee():O()}),(o,E)=>(P(),X("div",{ref_key:"container",ref:c,class:S([i(t).b(),o.$attrs.class]),style:we(i(A))},[g.value?ie(o.$slots,"error",{key:0},()=>[z("div",{class:S(i(t).e("error"))},_n(i(l)("el.image.error")),3)]):(P(),X(oe,{key:1},[v.value!==void 0?(P(),X("img",yn({key:0},i(s),{src:v.value,loading:o.loading,style:i(Y),class:i(I),crossorigin:o.crossorigin,onClick:te,onLoad:M,onError:W}),null,16,Ta)):F("v-if",!0),b.value?(P(),X("div",{key:1,class:S(i(t).e("wrapper"))},[ie(o.$slots,"placeholder",{},()=>[z("div",{class:S(i(t).e("placeholder"))},null,2)])],2)):F("v-if",!0)],64)),i(N)?(P(),X(oe,{key:2},[y.value?(P(),ye(i(ba),{key:0,"z-index":o.zIndex,"initial-index":i(R),infinite:o.infinite,"zoom-rate":o.zoomRate,"min-scale":o.minScale,"max-scale":o.maxScale,"url-list":o.previewSrcList,"hide-on-click-modal":o.hideOnClickModal,teleported:o.previewTeleported,"close-on-press-escape":o.closeOnPressEscape,onClose:Z,onSwitch:re},{default:H(()=>[o.$slots.viewer?(P(),X("div",Ea,[ie(o.$slots,"viewer")])):F("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):F("v-if",!0)],64)):F("v-if",!0)],6))}});var Aa=De(La,[["__file","image.vue"]]);const Ca=He(Aa);export{Ca as E,ca as d,xa as i,ge as t};
